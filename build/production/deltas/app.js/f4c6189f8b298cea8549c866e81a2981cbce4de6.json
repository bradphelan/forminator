["/*b61f6e2537cef3a59b73f59b7124d0e6c2ba01ab",42,227589,"var a;Ext.define(\"app.view.Canvas\",{xtype:\"canvas\",extend:\"Ext.Panel\",canvas:function(){return this.element.query(\"canvas\")[0]},config:{bubbleEvents:\"canvasResized\"},debounce:function(c,d){var b,e=this;b=null;return function(){var f;console.log(\"Nay! \"+b);if(b!=null){console.log(\"Clearing \"+b);window.clearTimeout(b);b=null}f=function(){console.log(\"Yay! \"+b);return c.apply(e,arguments)};return b=window.setTimeout(f,d)}},doResize:function(){var b;b=this.element.getSize();$(this.canvas()).width(b.width-10);$(this.canvas()).height(b.height-10);return this.fireEvent(\"canvasResized\",b)},initialize:function(){var b;this.setHtml(\"<canvas></canvas>\");this.addListener({resize:this.doResize,painted:this.doResize});b=this.element.getSize();$(this.canvas()).width(b.width-10);return $(this.canvas()).height(b.height-10)}});Ext.define(\"app.view.Sketch\",{extend:\"Ext.Panel\",xtype:\"sketch\",config:{cls:\"sketcher\",layout:\"vbox\",useToolbar:true,items:[{xtype:\"panel\",cls:\"tools\",html:\"<div class='toolbar'></div>\",align:\"left\",docked:\"top\"},{xtype:\"canvas\",border:\"1 1 1 1\",flex:1}]},insertTools:function(){var f,b,j,g,e,i,c,h,d;b=[\"#f00\",\"#ff0\",\"#0f0\",\"#0ff\",\"#00f\",\"#f0f\",\"#000\",\"#fff\"];for(g=0,i=b.length;g<i;g++){f=b[g];this.jqFind(\".tools\").append(\"<a href='#colors_sketch' data-color='\"+f+\"' style='background: \"+f+\";'></a> \")}h=[3,5,10,15];d=[];for(e=0,c=h.length;e<c;e++){j=h[e];d.push(this.jqFind(\".tools\").append(\"<a href='#colors_sketch' data-size='\"+j+\"' style='background: #ccc'>\"+j+\"</a> \"))}return d},canvasDOM:function(){return this.query(\"canvas\")[0].canvas()},jqFind:function(){var b;return $((b=this.element).query.apply(b,arguments))},resize:function(b){this.sketch.size=b;return this.sketch.redraw()},initialize:function(){var b,c=this;this.callParent();b=this.canvasDOM();this.sketch=new a(b);$(b).data(\"sketch\",this.sketch);if(this.getUseToolbar()){this.insertTools()}return this.addListener({canvasResized:function(d){return c.resize(d)}})}});a=(function(){b.name=\"Sketch\";function b(c,d){this.el=c;this.canvas=$(c);this.context=c.getContext(\"2d\");this.options=$.extend({toolLinks:true,defaultTool:\"marker\",defaultColor:\"#000000\",defaultSize:5},d);this.painting=false;this.color=this.options.defaultColor;this.size=this.options.defaultSize;this.tool=this.options.defaultTool;this.actions=[];this.action=[];this.canvas.bind(\"click mousedown mouseup mousemove mouseleave mouseout touchstart touchmove touchend touchcancel\",this.onEvent);if(this.options.toolLinks){$(\"body\").delegate('a[href=\"#'+(this.canvas.attr(\"id\"))+'\"]',\"click\",function(l){var h,k,g,m,j,f,i;k=$(this);h=$(k.attr(\"href\"));m=h.data(\"sketch\");i=[\"color\",\"size\",\"tool\"];for(j=0,f=i.length;j<f;j++){g=i[j];if(k.attr(\"data-\"+g)){m.set(g,$(this).attr(\"data-\"+g))}}if($(this).attr(\"data-download\")){m.download($(this).attr(\"data-download\"))}return false})}}b.prototype.download=function(d){var c;d||(d=\"png\");if(d===\"jpg\"){d=\"jpeg\"}c=\"image/\"+d;return window.open(this.el.toDataURL(c))};b.prototype.set=function(c,d){this[c]=d;return this.canvas.trigger(\"sketch.change\"+c,d)};b.prototype.startPainting=function(){this.painting=true;return this.action={tool:this.tool,color:this.color,size:parseFloat(this.size),events:[]}};b.prototype.stopPainting=function(){if(this.action){this.actions.push(this.action)}this.painting=false;this.action=null;return this.redraw()};b.prototype.onEvent=function(c){if(c.originalEvent&&c.originalEvent.targetTouches){c.pageX=c.originalEvent.targetTouches[0].pageX;c.pageY=c.originalEvent.targetTouches[0].pageY}$.sketch.tools[$(this).data(\"sketch\").tool].onEvent.call($(this).data(\"sketch\"),c);c.preventDefault();return false};b.prototype.redraw=function(){var c;this.el.width=this.canvas.width();this.el.height=this.canvas.height();this.context=this.el.getContext(\"2d\");c=this;$.each(this.actions,function(){if(this.tool){return $.sketch.tools[this.tool].draw.call(c,this)}});if(this.painting&&this.action){return $.sketch.tools[this.action.tool].draw.call(c,this.action)}};return b})();$.sketch={tools:{}};$.sketch.tools.marker={onEvent:function(b){switch(b.type){case\"mousedown\":case\"touchstart\":this.startPainting();break;case\"mouseup\":case\"mouseout\":case\"mouseleave\":case\"touchend\":case\"touchcancel\":this.stopPainting()}if(this.painting){this.action.events.push({x:b.pageX-this.canvas.offset().left,y:b.pageY-this.canvas.offset().top,event:b.type});return this.redraw()}},draw:function(g){var d,c,f,b,e;this.context.lineJoin=\"round\";this.context.lineCap=\"round\";this.context.beginPath();this.context.moveTo(g.events[0].x,g.events[0].y);e=g.events;for(f=0,b=e.length;f<b;f++){d=e[f];this.context.lineTo(d.x,d.y);c=d}this.context.strokeStyle=g.color;this.context.lineWidth=g.size;return this.context.stroke()}};$.sketch.tools.eraser={onEvent:function(b){return $.sketch.tools.marker.onEvent.call(this,b)},draw:function(c){var b;b=this.context.globalCompositeOperation;this.context.globalCompositeOperation=\"copy\";c.color=\"rgba(0,0,0,0)\";$.sketch.tools.marker.draw.call(this,c);return this.context.globalCompositeOperation=b}}",384895,42,227647,4307,383439,33,"Page\",{extend:\"Ext.Panel\",config:{scrollable:\"vertical\",last:false,pagesUI:null,page:null,record:null},areAllItemsOnPageSet:function(){var a,b=this;return true;a=true;this.getPage()",382726,38,"c){if(b.getRecord().get(c.get(\"name\"))===null){return a=false}});return a},updateState:function(){if(this.areAllItemsOnPageSet()){return this.down(\"[iconCls=arrow_right]\").setDisabled(false)}},configureListeners:function(){var a=this;return this.addListener(",381788,38,"b){a.getRecord().set(b.getName(),b.getValue());return a.updateState()}},",381952,36,"b){a.getRecord().set(b.getName(),b.getValue());return a.updateState(",381946,42,"b){a.getRecord().set(b.getName(),b.getValue());return a.updateState()}}})},currentIndex:function(){return this.getPagesUI().indexOf(this.getPagesUI().getActiveItem())",227275,44,"{xtype:\"titlebar\",title:this.getPage().get(\"title\"),docked:\"top\",items:[{iconCls:\"arrow_left\",cls:\"previous",382247,55,"a.getPagesUI().getLayout().setAnimation({type:\"slide\",direction:\"right\",duration:500});return a.getPagesUI().setActiveItem(a.currentIndex()-1)}}},{iconCls:\"arrow_right\",cls:\"next\",iconMask:true,align:\"right\",disabled:true,listeners:{tap:function(){a.getPagesUI().getLayout().setAnimation({type:\"slide\",direction:\"left\",duration:500});return a.getPagesUI().setActiveItem(a.currentIndex()+1)}}}]});this.add({xtype:\"panel\",items:[{xtype:\"label\",html:this.getPage().get(\"help\"),padding:20},{xtype:\"panel\",items:this.getPage().get(\"items\").getData().collect(function(b){return b.createComponent()})}]});if(this.getLast()){this",382896,179,"b){return b.fireEvent(\"submitForm\",a.getRecord())}}}]})}this.configureListeners();return this.updateState()",383422,54,"\",{extend:\"Ext.Panel\",config:{padding:0",276902,32,"type:\"slide\",direction:\"down\"}},scrollable:false,pages:null,record:null",381178,39,"Pages().getData().length",227275,35,"return this.add(this.getPages().getData().collect(function(c,b){return Ext.create(\"app.view.Page\",{last:b===a.pagesCount()-1,scrollable:\"vertical\",pagesUI:a,page:c,record:a.getRecord()})}",385245,35,"Label",236384,34,232009,270,"Password",129300,34,"password",125919,36,"Password\",config:{",129447,32,"type:\"password\"}}});Ext.define(\"Ext.field.Email\",{extend:\"Ext.field.Text\",alternateClassName:\"Ext.form.Email\",xtype:\"emailfield\",config:{component:{type:\"email\"},autoCapitalize:false}});Ext.define(\"Ext.field.Number",129300,34,"number",125919,36,"Number\",config:{component:{type:\"number\"},ui:\"number\"},proxyConfig:{",119573,42,"},apply",126600,32,"MinValue(),c=this.getMaxValue();if(Ext.isNumber(a)){b=Math.max(b,a)}if(Ext.isNumber(c)){b=Math.min(b,c)}return parseFloat(b",78701,34,"callParent();return parseFloat(a||0",128371,34,"getComponent().setValue(\"\");a.getValue();a.hideClearIcon()}});Ext.define(\"Ext.field.Url",129300,34,"url",125919,36,"Url\",config:{",129447,32,"type:\"url\"}}}",383437,35,"SketchField",125880,35,"sketchfield\",config:{component:{xtype:\"sketch\",minHeight:600,useToolbar:false",228158,34,232273,121970,"Field\"",381568,41,354291,36,"type\",type:\"string\",defaultValu",354308,66,"title",354332,42,"help",354332,42,"labelWidth\",type:\"string\",defaultValue:\"30%\"}]},createLabel:function(){var a;a=this.get(\"label\")!=null?this.get(\"label\"):this.get(\"name\");return Ext.String.capitalize(a.replace(/_/,\" \"))},createTitle:function(){return this.get(\"title\")},createInstruc",354556,34,"help\")},createItems:function(){var b,a,c;a=[];c=this.createTitle();b=this.createInstructions();a.push({xtype:\"fieldset\",items:[this.createField()],instructions:b,title:c});return a},createComponent:function(){return{xtype:\"panel\",items:this.createItems()}",383422,45,"model.form.Option\",{extend:\"app.model.form.Field\",config:{fields:[{name:\"options\",type:\"array\"}]},options:function(){var a;a=0;",354573,40,"b){b=(function(){if((b.text!=null)&&(b.value!=null)){return b}else{if(b.constructor===String){return{text:b,value:a}}else{if(!(b.value!=null)){b.value=a;return b}else{throw\"Arggh\"}}}})();a+=1;return b})}})}).call(this);(function(){var a=[].slice;Ext.define(\"app.model.form.Radio\",{extend:\"app.model.form.Option\",constructor:function(){var b;b=1<=arguments.length?a.call(arguments,0):[];return this.callParent(b)},config:{fields:[{name:\"labelWidth\",type:\"string\",defaultValue:\"90%\"}]},createTitle:function(){if(this.get(\"title\")!=null){return this.get(\"title\")}else{return this.createLabel()}},createRadios:function(){var b,c=this;b=this.options().map(function(e){var d;d={xtype:\"radiofield\",labelWidth:c.get(\"labelWidth\"),value:e.value,label:Ext.String.capitalize(e.text),name:c.get(\"name\")};return{xtype:\"panel\",items:[d,{xtype:\"label\",html:e.help,cls:\"assist\"}]}});return b},createInstructions:function(){var b;b=this.callParent();if(b!=null){return b}else{return\"&nbsp;\"}},createField:function(){return{xtype:\"panel\",items:this.createRadios()}",383422,45,"model.form.Select\",{extend:\"app.model.form.Option\",createField:function(){return{xtype:\"selectfield\",name:this.get(\"name\"),label:this.createLabel(),options:this.options()}",383422,45,"model.form.Sketch\",{extend:\"app.model.form.Field\",config:{fields:[{name:\"points\",type:\"array\"}]},requires:[\"app.view.SketchField\"],createField:function(){return{xtype:\"sketchfield\",minHeight:600,useToolbar:false,label:this.createLabel()}",383422,45,354782,25367,"Ext.define(\"Ext.picker.Date\",{extend:\"Ext.picker.Picker\",xtype:\"date",372463,32,"DatePicker\",requires:[\"Ext.DateExtras\"],config:{yearFrom:1980,yearTo:new Date().getFullYear(),monthText:\"Month\",dayText:\"Day\",yearText:\"Year\",slotOrder:[\"month\",\"day\",\"year\"]",117196,51,"scope:this,delegate:\"> slot\",slotpick:this.onSlotPick})},setValue:function(b,a){if(Ext.isDate(b)){b={day:b.getDate(),month:b.getMonth()+1,year:b.getFullYear()}}this.callParent([b,a])},getValue:function(){var h={},a,g,c,f,e=this.getItems().items,d=e.length,j,b;for(b=0;b<d;b++){j=e[b];if(j instanceof Ext.picker.Slot){h[j.getName()]=j.getValue()}}if(h.year===null&&h.month===null&&h.day===null){return null}f=Ext.isNumber(h.year)?h.year:1;c=Ext.isNumber(h.month)?h.month:1;g=Ext.isNumber(h.day)?h.day:1;if(c&&f&&c&&g){a=this.getDaysInMonth(c,f)}g=(a)?Math.min(g,a):g;return new Date(f,c-1,g)},updateYearFrom:function(){if(this.initialized){this.createSlots()}},updateYearTo:function(){if(this.initialized){this.createSlots()}},updateMonthText:function(a,b){var f=this.getInnerItems,e=f.length,d,c;if(this.initialized){for(c=0;c<e;c++){d=f[c];if((typeof d.title==\"string\"&&d.title==b)||(d.title.html==b)){d.setTitle(a)}}}},updateDayText:function(a,c){var f=this.getInnerItems,e=f.length,d,b;if(this.initialized){for(b=0;b<e;b++){d=f[b];if((typeof d.title==\"string\"&&d.title==c)||(d.title.html==c)){d.setTitle(a)}}}},updateYearText:function(e){var d=this.getInnerItems,c=d.length,b,a;if(this.initialized){for(a=0;a<c;a++){b=d[a];if(b.title==this.yearText){b.setTitle(e)}}}}",226350,51,"this.createSlots()},createSlots:function(){var k=this,c=this.getSlotOrder(),m=k.getYearFrom(),f=k.getYearTo(),g=[],l=[],b=[],j,e,d,a;if(m>f){e=m;m=f;f=e}for(d=m;d<=f;d++){g.push({text:d,value:d})}a=this.getDaysInMonth(1,new Date().getFullYear());for(d=0;d<a;d++){l.push({text:d+1,value:d+1})}for(d=0,j=Ext.Date.monthNames.length;d<j;d++){b.push({text:Ext.Date.monthNames[d],value:d+1})}var h=[];c.forEach(function(i){h.push(this.createSlot(i,l,b,g))},this);k.setSlots(h)},createSlot:function(b,d,a,c){switch(b){case\"year\":return{name:\"year\",align:\"center\",data:c,title:this.getYearText(),flex:3};case\"month\":return{name:b,align:\"right\",data:a,title:this.getMonthText(),flex:4};case\"day\":return{name:\"day\",align:\"center\",data:d,title:this.getDayText(),flex:2}}},onSlotPick:function(){var j=this.getValue(),h=this.getDaySlot(),f=j.getFullYear(),e=j.getMonth(),k=[],b=h,a,c;if(!j||!Ext.isDate(j)||!h){return}a=this.getDaysInMonth(e+1,f);for(c=0;c<a;c++){k.push({text:c+1,value:c+1})}if(h.getData().length==k.length){return}var g=h.getStore(),n=h.getViewItems(),m=h.getValueField(),d,l;h.setData(k);d=g.find(m,j.getDate());if(d==-1){return}l=Ext.get(n[d]);h.selectedIndex=d;h.scrollToItem(l);h._value=j},getDaySlot:function(){var c=this.getInnerItems(),b=c.length,a,d;if(this.daySlot){return this.daySlot}for(a=0;a<b;a++){d=c[a];if(d.isSlot&&d.getName()==\"day\"){this.daySlot=d;return d}}return null},getDaysInMonth:function(c,b){var a",69756,46,"c==2&&this.isLeapYear(b)?29:a[c-1]},isLeapYear:function(a){return !!((a&3)===0&&(a%100||(a%400===0&&a)",374499,71,".toDateString()!=a.toDateString()",374573,46,"});Ext.define(\"Ext.field.DatePicker\",{extend:\"Ext.field.Text\",alternateClassName:\"Ext.form.DatePicker\",xtype:\"datepickerfield\",requires:[\"Ext.picker.Date\",\"Ext.DateExtras\"],config:{ui:\"select\",picker:true,clearIcon:false,destroyPickerOnHide:false,dateFormat:null,component:{useMask:true}",117196,47,"getComponent().on({scope:this,masktap:\"onMaskTap\"});this.getComponent().input.dom.disabled=true",376516,47,"a){if(!Ext.isDate(a)&&!Ext.isObject(a)){a=null}if(Ext.isObject(a)){a=new Date(a.year,a.month-1,a.day",376800,34,"){var a=this._picker;if(a&&a.isPicker){a.setValue(b)}if(b!==null){this.getComponent().setValue(Ext.Date.format(b,this.getDateFormat()",73082,36,")}else{this.getComponent().setValue(\"\")}if(this._picker&&this._picker instanceof Ext.picker.Date){this._picker.setValue(b)}},updateDateFormat:function(c,a){var b=this.getValue();if(c!=a&&Ext.isDate(b)&&this._picker&&this._picker instanceof Ext.picker.Date){this.getComponent().setValue(",73063,55,")}},getValue:function(){if(this._picker&&this._picker instanceof Ext.picker.Date){return this._picker.getValue()}return this._value},getFormatted",126600,32,"Value();return(Ext.isDate(a))?Ext.Date.format(a,b||this.getDateFormat()",73082,36,":a},applyPicker:function(b,a){if(a&&a.isPicker){b=a.setConfig(b)}return b},getPicker:function(){var a=this._picker;if(a&&!a.isPicker){a=Ext.factory(a,Ext.picker.Date);a.on({scope:this,change:\"onPickerChange\",hide:\"onPickerHide\"});a.setValue(this.getValue());Ext.Viewport.add(a);this._picker=a}return a",377932,59,"if(this.getReadOnly()){return false}this.getPicker().show();return false},onPickerChange:function(a,c){var b=this;b.setValue(c);b.fireEvent(\"change\",b,b.getValue())},onPickerHide:function(){var a=this.getPicker();if(this.getDestroyPickerOnHide()&&a){a.destroy();this._picker=true}",125740,52,158815,35,"Picker();if(a&&a.isPicker){a.destroy(",50510,32,226285,34,"form.Text\",{extend:\"app.model.form.Field\",requires:[\"Ext.form.DatePicker\",\"Ext.form.Password\",\"Ext.form.Email\",\"Ext.form.Number\",\"Ext.form.TextArea\",\"Ext.form.Url\"],mapXType:function(){switch(this.get(\"type\")){case\"password\":return\"passwordfield\";case\"email\":return\"emailfield\";case\"date\":return\"datepickerfield\";case\"url\":return\"urlfield\";case\"integer\":case\"int\":return\"numberfield\";case\"float\":return\"numberfield\";default:return\"textfield\"}},createField:function(){return{xtype:this.mapXType(),name:this.get(\"name\"),label:this.createLabel(),labelWrap:true}",383422,45,380177,146,"form.Radio\",\"app.model.form.Select\",\"app.model.form.Text\",\"app.model.form.Field\",\"app.model.form.Sketch\",\"app.model.Page\",\"app.view.Page\",\"app.view.Form",380327,243,"type===\"sketch\"){return\"app.model.form.Sketch\"}else{if(a.options!=null){return\"app.model.form.Radio\"",380672,35,"}",265531,36,380743,437,381245,408,381660,53,"app.view.Form\",{title:this.get(\"title\"),pages:this.get(\"pages\"),record:a",383129,1472,",\"app.view.Sketch\"]",117197,39,"arguments);this.getNavigationBar().hide();",384669,43,";return this.push({xtype:\"formkiosk\"}",384711,93,",c=this",384804,62,"Ext.Viewport.add(a);return Ext.Ajax.request({params:JSON.stringify(b.getData(),void 0,2),method:\"POST\",headers:{\"Content-Type\":\"application/json;charset=utf-8\"},url:\"/form.json\",success:function(d){return console.log(\"YAY\")},error:function(){return console.log(\"Nein",383856,50,384937,96,"if(Ext.browser.userAgent.match(/PhantomJS/)){return false}",385033,45,"(Ext.browser.is.IE||Ext.browser.is.WebKit||Ext.browser.is.Gecko||Ext.browser.is.Opera)",385099,1572]